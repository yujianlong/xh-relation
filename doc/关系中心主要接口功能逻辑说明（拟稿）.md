用户关系中心主要接口功能逻辑说明（拟稿）
========================

##关系类型：

1. 好友请求关系
> 单向关系，操作用户向目标用户发出好友请求。表示操作用户期望跟目标用户成为好友的一种状态。
2. 好友关系
> 双向关系，两个用户是好友。*可相互看到好友动态。*
3. 关注关系
> 单向关系，操作用户关注了目标用户。*操作用户可以看到目标用户的关注动态。*
4. 黑名单关系
> 单向关系，操作用户将目标用户拉黑。表示两者之间不再有任何关系，之间也不能再进行好友请求、加关注操作。
5. 阻止关系(不让TA看我)
> 单向关系，操作用户阻止了目标用户。表示操作用户虽然被目标用户关注了或两者已经是好友，但操作用户又阻止了目标用户。*目标用户将无法看到操作用户的任何动态。*
6. 屏蔽关系(我不看TA)
> 单向关系，操作用户屏蔽了目标用户。表示操作用户虽然关注了目标用户或两者已经是好友，但操作用户又屏蔽了目标用户。*操作用户将无法看到目标用户的任何动态。*

*注：斜体表示外围应用对该关系的使用场景，上面提到的“动态”一概念并非存在于本系统中。*


##关系主要接口功能逻辑说明：

- 操作用户向目标用户发送好友请求
> 1. 若操作用户拉黑了目标用户，或目标用户拉黑了操作用户，或两者已经是好友，均无法发送好友请求。
> 2. 建立操作用户对目标用户的好友请求关系，可指定附言。

- 操作用户同意目标用户发送的好友请求
> 1. 删除目标用户向操作用户发送的好友请求；删除操作用户向目标用户发送的好友请求（若存在）。
> 2. 建立好友关系。（目标用户会在操作用户的指定的好友分组中，且可指定备注及是否私密好友；操作用户会在目标用户的名为“默认分组”的好友分组里，且为非私密好友。）

- 操作用户拒绝目标用户发送的好友请求
> 1. 删除目标用户向操作用户发送的好友请求。
> 2. 删除操作用户向目标用户发送的好友请求（若存在）。

- 删除好友
> 1. 若不存在关注（目标用户关注了操作用户）关系，但存在阻止（操作用户阻止了目标用户）关系，则删除该阻止关系。
> 2. 若不存在关注（操作用户关注了目标用户）关系，但存在屏蔽（操作用户屏蔽了目标用户）关系，则删除该屏蔽关系。
> 3. 删除好友关系（双向）。

- 关注目标用户
> 1. 若操作用户拉黑了目标用户，或目标用户拉黑了操作用户，均无法添加关注关系。
> 2. 添加关注关系，可指定备注。

- 取消对目标用户的关注
> 1. 判断是否存在好友关系，如不存在好友关系，但存在阻止（目标用户阻止了操作用户）或屏蔽（操作用户屏蔽了目标用户）关系，则删除该阻止及屏蔽关系。
> 2. 删除关注关系。

- 拉黑目标用户
> 1. 判断是否存在好友关系，不存在则无法添加黑名单。
> 2. 删除一切关系（关注、阻止、好友）。
> 3. 建立黑名单关系。

- 取消对目标用户的拉黑
> 删除黑名单关系。

- 阻止目标用户
> 1. 判断是否存在好友关系或者关注（目标用户关注了操作用户）关系，如果二者都不存在，则无法添加阻止。
> 2. 添加阻止关系。

- 取消对目标用户的阻止
> 删除阻止关系。

- 屏蔽目标用户
> 1. 判断是否存在好友关系或者关注（操作用户关注了目标用户）关系，如果二者都不存在，则无法添加屏蔽。
> 2. 添加屏蔽关系。

10. 取消对目标用户的屏蔽
> 删除屏蔽关系。


**注：**
> 1. 所有关系都不能重复存在。即同方向同类型的关系只能有一条。
> 2. 好友关系必须是成对存在的双向关系。其他关系均为单向关系：是独立存在的，跟对向关系(若存在)是互不影响的。
> 3. 当且仅当两个用户间存在至少一条好友请求关系时，才能建立好友关系。
> 4. 两个用户间的好友请求关系和好友关系不能共存。
> 5. 当且仅当两个用户间存在好友关系时，才能建立黑名单关系。
> 6. 黑名单关系不能跟任何其他关系共存。
> 7. 阻止关系必须跟“好友关系和关注（单向）关系两种之一”共存，不能单独存在。
> 8. 屏蔽关系必须跟“好友关系和关注（单向）关系两种之一”共存，不能单独存在。
> 9. 任何关系的创建、删除和修改等，本系统不涉及消息的处理，由外围应用或消息中心系统实现。
